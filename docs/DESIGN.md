# Design Doc

[#7](https://github.com/kmyk/Jikka/pull/7) も読んでね


## Objective

Jikka は、競技プログラミングの問題を解く行為そのものを自動化するツールである。
特にこれを「最適化トランスパイラ」の形に落とし込んで実現する。

## Goals

-   形式的な形で与えられた競技プログラミングの問題の解法を自動で生成すること。またこれによりユーザのレートを上げること
-   競技プログラミングにおける機械的に処理できる部分を機械的に処理することによって、機械的には処理できないより本質的でおもしろい部分に人間が集中できるようにすること


## Non-Goals

-   自然言語で与えられた競技プログラミングの問題の解法を自動で生成すること
-   競技プログラミングにおける機械的に処理できる部分を機械的に処理することによって、競技プログラミングという遊びを spoil すること


## Background

競技プログラミングの問題を解く過程は以下の 3 ステップに大別できる。

1.  形式化: 自然言語で与えられた問題を解釈し、数学的で形式的な問題として整理する
2.  考察: 数学的で形式的な問題に対し、数学的で抽象的な解法を考案する
3.  実装: 数学的で抽象的な解法を、計算機における具体的な実装として記述する

競技プログラミングの (すくなくとも AtCoder で出題されるような問題の) 中心であり最もおもしろくかつ難しい部分は「考察」の部分であると考えられている。
しかしこの「考察」にも、一定の知識があれば機械的に可能であるような部分は多く含まれている。
Jikka はそのような機械的な考察を処理する。


## Overview

Jikka はその概観としてはただのトランスパイラである。
Python のとても制限されたサブセットとして書かれたソースコードを受けとり、内部で大域的な最適化を行い、最終的に C++ 言語として出力する。


## Detailed Design

### なぜトランスパイラであるか

TODO: 書く

### なぜ出力言語は C++ であるか

理由は 2 点ある。

1.  利用しやすい: 競プロという用途において柔軟な利用が可能になるから
2.  開発しやすい: 局所的な最適化をまったく回避できるから

他の有力な選択肢は次のようになるだろう。

-   実行ファイルを出力する
-   何も出力しない (インタプリタとしてのみ振る舞う)
-   何も出力しない (ライブラリとして振る舞う。例: [Numba](https://numba.pydata.org/))
-   Python を出力する
-   Rust を出力する

「実行ファイル」「インタプリタ」「ライブラリ」の方針はどれも競技プログラミングでの実用が難しい。
ほとんどのオンラインジャッジは未だ「単一のソースコードを提出する」という方式が主流であるためである。
ソースコードをそのまま出力するものでないと、出力結果の提出ができない。

Python を出力する方針は利用が難しい。
Python は C++ と比べて遅いためである。
十分に性質を理解した上でなら大きな問題にはならない (証拠: Python のみで AtCoder 橙の人が存在する) とはいえ、たいていのユーザにとっては不利な言語であろう。

Rust を出力する方針は開発も利用も難しい。
Rust の厳密な型検査に合致するコードの出力は面倒であり、また競プロでの実用レベルで Rust を習得しているユーザは少ない。

### なぜ入力言語は Python であるか

理由は 2 点ある。

1.  開発しやすい: 出力とのギャップを減らし実装を容易にするため
2.  利用しやすい: 広く普及しているほどよく高級な言語であるため

他の有力な選択肢は次のようになるだろう。

-   C++ を入力する
-   Lisp を入力する
-   ML を入力する
-   Haskell を入力する

TODO: 書く


## Metrics Considerations

適切な仮定の下で「AtCoder 上でのレート」という形で性能評価が可能である。
また「AtCoder Beginner Contest などの問題のうち何割が解ける」などの形での評価も可能だろう。


## Testing Plan

効率良く実行できる安定した end-to-end テストが簡単に書けるため、これを利用するのがよいだろう。
つまり、俗に「verify する」と呼ばれる、実際の競技プログラミングの問題に対して利用して AC を確認するという形式のテストに類似したものが可能である。
